<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Juego para Biolog√≠a</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #a8edea, #fed6e3);
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
  }

  #game-container {
    background: white;
    border-radius: 20px;
    padding: 30px;
    text-align: center;
    width: 90%;
    max-width: 600px;
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    position: relative;
  }

  h1 {
    color: #3c3c3c;
  }

  .btn {
    background-color: #4CAF50;
    color: white;
    border: none;
    padding: 12px 24px;
    font-size: 18px;
    border-radius: 10px;
    cursor: pointer;
    margin: 10px;
  }

  .btn:hover {
    background-color: #45a049;
  }

  .option {
    display: block;
    background: #f1f1f1;
    border: 2px solid transparent;
    margin: 8px 0;
    padding: 10px;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .option:hover {
    background: #d4ffd6;
  }

  #question-img {
    width: 100%;
    max-height: 250px;
    object-fit: contain;
    margin: 10px 0;
    border-radius: 10px;
  }

  #feedback {
    font-weight: bold;
    margin-top: 10px;
  }

  #musicBtn {
    position: fixed;
    top: 15px;
    right: 15px;
    background: rgba(255,255,255,0.8);
    color: #333;
    border: none;
    font-size: 20px;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
  }

  #musicBtn:hover {
    background: #f5f5f5;
  }

  input {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
    width: 80%;
    font-size: 16px;
    margin-bottom: 10px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }

  th, td {
    border-bottom: 1px solid #ccc;
    padding: 8px;
  }

  th {
    background-color: #f5f5f5;
  }

  .leaderboard {
    text-align: left;
  }
</style>
</head>
<body>

<!-- Bot√≥n de m√∫sica -->
<button id="musicBtn">üîä</button>

<div id="game-container">
  <h1 id="title">Juego para Biolog√≠a</h1>

  <!-- Pantalla de inicio -->
  <div id="start-screen">
    <input type="text" id="username" placeholder="Ingresa tu nombre">
    <br>
    <button id="startBtn" class="btn">Comenzar</button>
  </div>

  <!-- Contenedor de preguntas -->
  <div id="question-container" style="display:none;">
    <h2 id="question-text"></h2>
    <img id="question-img" src="" alt="" style="display:none;">
    <div id="options"></div>
    <div id="feedback"></div>
    <button id="nextBtn" class="btn" style="display:none;">Siguiente</button>
  </div>

  <!-- Tabla de puntuaciones -->
  <div id="leaderboard" class="leaderboard" style="display:none;"></div>
</div>

<!-- üéµ M√∫sica de fondo -->
<audio id="bg-music" 
  src="https://www.bensound.com/bensound-music/bensound-sunny.mp3" 
  autoplay loop></audio>

<script>
const questions = [
  { text: "¬øCu√°l es la funci√≥n principal de los test√≠culos?", options: ["Producir espermatozoides y testosterona", "Fabricar √≥vulos", "Regular la temperatura corporal", "Almacenar orina"], correct: 0, image: "" },
  { text: "¬øEn qu√© √≥rgano se produce la fecundaci√≥n normalmente?", options: ["√ötero", "Trompas de Falopio", "Ovario", "Vagina"], correct: 1, image: "" },
  { text: "¬øQu√© estructura transporta los espermatozoides desde el epid√≠dimo hasta la uretra?", options: ["Conducto deferente", "Ves√≠cula seminal", "Pr√≥stata", "Uretra"], correct: 0, image: "" },
  { text: "¬øD√≥nde se desarrolla el embri√≥n despu√©s de la fecundaci√≥n?", options: ["Ovario", "Trompas de Falopio", "√ötero", "Vagina"], correct: 2, image: "" },
  { text: "¬øQu√© c√©lula del aparato reproductor femenino se une con el espermatozoide?", options: ["√ìvulo", "Cigoto", "Embri√≥n", "Fol√≠culo"], correct: 0, image: "" },
  { text: "¬øQu√© gl√°ndula produce un l√≠quido que nutre a los espermatozoides?", options: ["Pr√≥stata", "H√≠gado", "P√°ncreas", "Tiroides"], correct: 0, image: "" },
  { text: "¬øCu√°l de las siguientes estructuras produce √≥vulos?", options: ["Ovarios", "√ötero", "Trompas de Falopio", "Vagina"], correct: 0, image: "" },
  { text: "¬øQu√© parte del aparato reproductor femenino conecta el √∫tero con el exterior?", options: ["Ovario", "Vagina", "C√©rvix", "Trompas de Falopio"], correct: 1, image: "" },
  { text: "¬øC√≥mo se llama la uni√≥n del espermatozoide con el √≥vulo?", options: ["Implantaci√≥n", "Fecundaci√≥n", "Menstruaci√≥n", "Ovulaci√≥n"], correct: 1, image: "" },
  { text: "¬øD√≥nde se almacenan temporalmente los espermatozoides antes de ser expulsados?", options: ["Epid√≠dimo", "Ves√≠culas seminales", "Pr√≥stata", "Pene"], correct: 0, image: "" }
];

let shuffledQuestions = [];
let currentQuestionIndex = 0;
let score = 0;
let username = "";
let startTime = 0;
let endTime = 0;

const startScreen = document.getElementById("start-screen");
const startBtn = document.getElementById("startBtn");
const usernameInput = document.getElementById("username");
const questionContainer = document.getElementById("question-container");
const questionText = document.getElementById("question-text");
const questionImg = document.getElementById("question-img");
const optionsDiv = document.getElementById("options");
const feedback = document.getElementById("feedback");
const nextBtn = document.getElementById("nextBtn");
const leaderboardDiv = document.getElementById("leaderboard");
const music = document.getElementById("bg-music");
const musicBtn = document.getElementById("musicBtn");

startBtn.addEventListener("click", startGame);
nextBtn.addEventListener("click", nextQuestion);
musicBtn.addEventListener("click", toggleMusic);

function startGame() {
  username = usernameInput.value.trim();
  if (username === "") {
    alert("Por favor ingresa tu nombre antes de comenzar.");
    return;
  }
  startScreen.style.display = "none";
  questionContainer.style.display = "block";
  shuffledQuestions = [...questions].sort(() => Math.random() - 0.5);
  currentQuestionIndex = 0;
  score = 0;
  startTime = Date.now();
  showQuestion();
}

function showQuestion() {
  feedback.textContent = "";
  nextBtn.style.display = "none";
  const currentQuestion = shuffledQuestions[currentQuestionIndex];
  questionText.textContent = currentQuestion.text;
  optionsDiv.innerHTML = "";

  if (currentQuestion.image) {
    questionImg.src = currentQuestion.image;
    questionImg.style.display = "block";
  } else {
    questionImg.style.display = "none";
  }

  currentQuestion.options.forEach((option, index) => {
    const btn = document.createElement("div");
    btn.textContent = option;
    btn.classList.add("option");
    btn.onclick = () => selectOption(index, currentQuestion.correct);
    optionsDiv.appendChild(btn);
  });
}

function selectOption(selectedIndex, correctIndex) {
  const allOptions = document.querySelectorAll(".option");
  allOptions.forEach(opt => opt.style.pointerEvents = "none");

  if (selectedIndex === correctIndex) {
    feedback.textContent = "‚úÖ ¬°Correcto!";
    feedback.style.color = "green";
    score++;
  } else {
    feedback.textContent = "‚ùå Incorrecto";
    feedback.style.color = "red";
  }
  nextBtn.style.display = "block";
}

function nextQuestion() {
  currentQuestionIndex++;
  if (currentQuestionIndex < shuffledQuestions.length) {
    showQuestion();
  } else {
    endGame();
  }
}

function endGame() {
  endTime = Date.now();
  const total = shuffledQuestions.length;
  const percentage = Math.round((score / total) * 100);
  const timeTaken = ((endTime - startTime) / 1000).toFixed(1);

  saveScore(username, score, percentage, timeTaken);
  showLeaderboard();
}

// Guardar puntuaci√≥n en localStorage
function saveScore(name, score, percentage, time) {
  let leaderboard = JSON.parse(localStorage.getItem("bioLeaderboard")) || [];
  leaderboard.push({ name, score, percentage, time });
  leaderboard.sort((a, b) => b.score - a.score || a.time - b.time);
  leaderboard = leaderboard.slice(0, 5); // Top 5
  localStorage.setItem("bioLeaderboard", JSON.stringify(leaderboard));
}

// Mostrar tabla de posiciones
function showLeaderboard() {
  const leaderboard = JSON.parse(localStorage.getItem("bioLeaderboard")) || [];
  questionContainer.style.display = "none";
  leaderboardDiv.style.display = "block";

  let table = `
    <h2>üèÅ Resultados finales</h2>
    <p>${username}, acertaste <strong>${score}</strong> de <strong>${questions.length}</strong> preguntas.</p>
    <h3>Puntaje: ${Math.round((score / questions.length) * 100)}%</h3>
    <p>Tiempo total: ${((endTime - startTime) / 1000).toFixed(1)} segundos</p>
    <h3>üèÜ Leaderboard</h3>
    <table>
      <tr><th>Jugador</th><th>Puntaje</th><th>%</th><th>Tiempo (s)</th></tr>
  `;
  leaderboard.forEach(p => {
    table += `<tr><td>${p.name}</td><td>${p.score}</td><td>${p.percentage}%</td><td>${p.time}</td></tr>`;
  });
  table += `</table><button class="btn" onclick="location.reload()">Jugar otra vez</button>`;
  leaderboardDiv.innerHTML = table;
}

// üéµ Control de sonido
function toggleMusic() {
  if (music.paused) {
    music.play();
    musicBtn.textContent = "üîä";
  } else {
    music.pause();
    musicBtn.textContent = "üîà";
  }
}
</script>
</body>
</html>
